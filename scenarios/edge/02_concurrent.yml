# Edge 02: Concurrent Facilities - multiple loans same customer
name: edge_02_concurrent
seed: 60200
start_time: "2024-04-01T09:00:00Z"

events:
  - event: CustomerEvent::Initialized
    entity: customer_1
    values: {email: "multi.loan@example.com", customer_type: Business}

  - event: CollateralEvent::Initialized
    entity: collateral_1
    after: 24h

  - event: CollateralEvent::UpdatedViaManualInput
    entity: collateral_1
    after: 1h
    values: {collateral: 50000000}

  - event: CreditFacilityEvent::Initialized
    entity: facility_1
    after: 24h
    values:
      customer_id_ref: customer_1
      collateral_id_ref: collateral_1
      amount: 500000
      collateralization_state: FullyCollateralized
      collateral: 50000000
      price: "50000.00"
      terms:
        annual_rate: "0.10"
        duration: {Months: 6}
        interest_due_duration_from_accrual: {Days: 30}
        accrual_cycle_interval: EndOfMonth
        accrual_interval: EndOfDay
        one_time_fee_rate: "0.01"
        liquidation_cvl: {Finite: "1.10"}
        margin_call_cvl: {Finite: "1.25"}
        initial_cvl: {Finite: "1.40"}
        disbursal_policy: SingleDisbursal

  - event: DisbursalEvent::Settled
    entity: disbursal_1
    after: 24h

  - event: CollateralEvent::Initialized
    entity: collateral_2
    after: 30d

  - event: CollateralEvent::UpdatedViaManualInput
    entity: collateral_2
    after: 1h
    values: {collateral: 75000000}

  - event: CreditFacilityEvent::Initialized
    entity: facility_2
    after: 24h
    values:
      customer_id_ref: customer_1
      collateral_id_ref: collateral_2
      amount: 750000
      collateralization_state: FullyCollateralized
      collateral: 75000000
      price: "50000.00"
      terms:
        annual_rate: "0.12"
        duration: {Months: 12}
        interest_due_duration_from_accrual: {Days: 30}
        accrual_cycle_interval: EndOfMonth
        accrual_interval: EndOfDay
        one_time_fee_rate: "0.015"
        liquidation_cvl: {Finite: "1.10"}
        margin_call_cvl: {Finite: "1.25"}
        initial_cvl: {Finite: "1.40"}
        disbursal_policy: SingleDisbursal

  - event: DisbursalEvent::Settled
    entity: disbursal_2
    after: 24h

  - event: CreditFacilityEvent::Completed
    entity: facility_1
    after: 120d

  - event: CreditFacilityEvent::Completed
    entity: facility_2
    after: 200d
